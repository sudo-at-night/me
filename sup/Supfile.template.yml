networks:
    production:
        hosts:
            - ${SSH_USER}@${SSH_HOST}
commands:
    cleanup:
        desc: Clear server's static files
        run: docker-compose -f .cdocker/compose/me-nginx/compose.yml down && docker volume rm me && docker volume create me && docker-compose -f .cdocker/compose/me-nginx/compose.yml up -d
    upload:
        desc: Upload built files
        upload:
            - src: ./dist
              dst: .cdocker/vlm/me/
        run: docker container create --name temp -v me:/data busybox && docker cp .cdocker/vlm/me/dist/. temp:/data/ && docker rm temp
targets:
    deploy:
        - cleanup
        - upload
